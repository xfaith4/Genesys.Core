name: CI

on:
  pull_request:
  workflow_dispatch:

jobs:
  pester:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
  
      - name: Install Pester
        shell: pwsh
        run: |
          if (-not (Get-Module -ListAvailable -Name Pester)) {
            Install-Module -Name Pester -Force -Scope CurrentUser -SkipPublisherCheck
          }

      - name: Run Pester
        shell: pwsh
        run: |
          $config = . ./tests/PesterConfiguration.ps1
          Invoke-Pester -Configuration $config
